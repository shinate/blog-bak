---
layout: post
status: publish
published: true
title: MySQL调优工具
author:
  display_name: "莳子"
  login: admin
  email: shine.wangrs@gmail.com
  url: http://codante.org
author_login: admin
author_email: shine.wangrs@gmail.com
author_url: http://codante.org
excerpt: MySQL究竟要如何配置？怎么调优？我该做些什么？都有哪些关键的指标？本文提供了一个解决方案！
wordpress_id: 37
wordpress_url: http://codante.org/?p=37
date: '2010-06-12 14:52:47 +0800'
date_gmt: '2010-06-12 06:52:47 +0800'
---
<p>[root@killer mysql]# sh tuning-primer.sh</p>
<p>Using login values from ~/.my.cnf<br />
- INITIAL LOGIN ATTEMPT FAILED -<br />
Testing for stored webmin passwords:<br />
None Found<br />
Could not auto detect login info!<br />
Found Sockets: /var/lib/mysql/mysql.sock<br />
Using: /var/lib/mysql/mysql.sock<br />
Would you like to provide a different socket?: [y/N] n  此处选N即可<br />
Do you have your login handy ? [y/N] : y<br />
User: 连接mysql用户名<br />
Password: 密码</p>
<p>Would you like me to create a ~/.my.cnf file for you? [y/N] : y</p>
<p>~/.my.cnf already exists!  由于刚才我配置过了，这里提示该文件已存在，不鸟它，继续</p>
<p>Replace ? [y/N] : y     替换它,然后。。。耐心等待。报表出现<br />
报表样例<br />
PS:这是我的测试机。。。。没怎么用过。。。还是奔4的呢。。。</p>
<p>[code]<br />
-- MYSQL PERFORMANCE TUNING PRIMER --<br />
- By: Matthew Montgomery -</p>
<p>MySQL Version 5.1.30 i686</p>
<p>Uptime = 30 days 11 hrs 21 min 37 sec<br />
Avg. qps = 0<br />
Total Questions = 519166<br />
Threads Connected = 1</p>
<p>Server has been running for over 48hrs.<br />
It should be safe to follow these recommendations</p>
<p>To find out more information on how each of these<br />
runtime variables effects performance visit:<br />
http://dev.mysql.com/doc/refman/ ... stem-variables.html<br />
Visit http://www.mysql.com/products/enterprise/advisors.html<br />
for info about MySQL's Enterprise Monitoring and Advisory Service</p>
<p>SLOW QUERIES<br />
The slow query log is NOT enabled.<br />
Current long_query_time = 10.000000 sec.<br />
You have 1 out of 519187 that take longer than 10.000000 sec. to complete<br />
Your long_query_time seems to be fine</p>
<p>BINARY UPDATE LOG<br />
The binary update log is NOT enabled.<br />
You will not be able to do point in time recovery<br />
See http://dev.mysql.com/doc/refman/ ... -time-recovery.html</p>
<p>WORKER THREADS<br />
Current thread_cache_size = 0<br />
Current threads_cached = 0<br />
Current threads_per_sec = 1<br />
Historic threads_per_sec = 0<br />
Your thread_cache_size is fine</p>
<p>MAX CONNECTIONS<br />
Current max_connections = 151<br />
Current threads_connected = 1<br />
Historic max_used_connections = 8<br />
The number of used connections is 5% of the configured maximum.<br />
You are using less than 10% of your configured max_connections.<br />
Lowering max_connections could help to avoid an over-allocation of memory<br />
See "MEMORY USAGE" section to make sure you are not over-allocating</p>
<p>INNODB STATUS<br />
Current InnoDB index space = 99 M<br />
Current InnoDB data space = 449 M<br />
Current InnoDB buffer pool free = 0 %<br />
Current innodb_buffer_pool_size = 8 M<br />
Depending on how much space your innodb indexes take up it may be safe<br />
to increase this value to up to 2 / 3 of total system memory</p>
<p>MEMORY USAGE<br />
Max Memory Ever Allocated : 39 M<br />
Configured Max Per-thread Buffers : 405 M<br />
Configured Max Global Buffers : 17 M<br />
Configured Max Memory Limit : 423 M<br />
Physical Memory : 1.97 G<br />
Max memory limit seem to be within acceptable norms</p>
<p>KEY BUFFER<br />
No key reads?!<br />
Seriously look into using some indexes<br />
Current MyISAM index space = 132 K<br />
Current key_buffer_size = 7 M<br />
Key cache miss rate is 1 : 0<br />
Key buffer free ratio = 88 %<br />
Your key_buffer_size seems to be fine</p>
<p>QUERY CACHE<br />
Query cache is supported but not enabled<br />
Perhaps you should set the query_cache_size</p>
<p>SORT OPERATIONS<br />
Current sort_buffer_size = 2 M<br />
Current read_rnd_buffer_size = 256 K<br />
Sort buffer seems to be fine</p>
<p>JOINS<br />
Current join_buffer_size = 132.00 K<br />
You have had 0 queries where a join could not use an index properly<br />
Your joins seem to be using indexes properly</p>
<p>OPEN FILES LIMIT<br />
Current open_files_limit = 1024 files<br />
The open_files_limit should typically be set to at least 2x-3x<br />
that of table_cache if you have heavy MyISAM usage.<br />
Your open_files_limit value seems to be fine</p>
<p>TABLE CACHE<br />
Current table_open_cache = 64 tables<br />
Current table_definition_cache = 256 tables<br />
You have a total of 93 tables<br />
You have 64 open tables.<br />
Current table_cache hit rate is 8%<br />
, while 100% of your table cache is in use<br />
You should probably increase your table_cache</p>
<p>TEMP TABLES<br />
Current max_heap_table_size = 16 M<br />
Current tmp_table_size = 16 M<br />
Of 15443 temp tables, 1% were created on disk<br />
Created disk tmp tables ratio seems fine</p>
<p>TABLE SCANS<br />
Current read_buffer_size = 128 K<br />
Current table scan ratio = 11 : 1<br />
read_buffer_size seems to be fine</p>
<p>TABLE LOCKING<br />
Current Lock Wait ratio = 0 : 519442<br />
Your table locking seems to be fine<br />
[/code]</p>
