---
layout: post
status: publish
published: true
title: CSS Expression（动态属性）用法总结
author:
  display_name: "莳子"
  login: admin
  email: shine.wangrs@gmail.com
  url: http://codante.org
author_login: admin
author_email: shine.wangrs@gmail.com
author_url: http://codante.org
wordpress_id: 482
wordpress_url: http://codante.org/?p=482
date: '2011-02-11 09:28:41 +0800'
date_gmt: '2011-02-11 01:28:41 +0800'
---
<h2>CSS Expression</h2>
<p>动态 css属性，ie 私有，从5.0开始引入（IE8 不支持），参考 <a href="http://msdn.microsoft.com/en-us/library/ms537634.aspx">MSDN</a>。一般只用在IE6的hack。</p>
<h3>优点</h3>
<p>css属性动态生成，所以基本 js 能做的它都能做。选择器用的是 css的，比 js 方便得多。</p>
<h3>缺点</h3>
<p>expression 会反复执行，有严重的效率问题。触发方式并不是通过事件，类似于js中的 interval 。</p>
<h2>实例</h2>
<h3>背景闪烁</h3>
<p>IE6的背景闪烁Bug Fix<br />
[css]<br />
body {<br />
    zoom: expression(function(el){<br />
    document.execCommand('BackgroundImageCache', false, true);<br />
    el.style.zoom = '1';<br />
    }(this));<br />
}<br />
[/css]</p>
<h3>input样式</h3>
<p>给不同 type 的 input 赋予不同的样式<br />
[css]<br />
input {<br />
    zoom: expression(function(el){<br />
        el.style.zoom = "1";<br />
        el.className ? el.className+=" "+el.type : el.className=el.type;<br />
    }(this));<br />
}<br />
[/css]</p>
<h3>隔行换色</h3>
<p>zebra lists<br />
[css]<br />
.test {<br />
    unicode-bidi: expression(function(el){<br />
        el.style.unicodeBidi = "normal";<br />
        var childs = el.getElementsByTagName("li");<br />
        for(var i=0; i<childs.length; i++){<br />
            (i % 2)?childs[i].className+=" even":childs[i].className+=" odd";<br />
        }<br />
    }(this));<br />
}<br />
[/css]</p>
<h3>:befor,:after</h3>
<p>模拟" :before" 或者 ":after"<br />
[css]<br />
.test {<br />
    letter-spacing: expression(function(el){<br />
        el.style.letterSpacing = "0";<br />
        var newchild = document.createElement("span");<br />
        newchild.className="after";<br />
        newchild.appendChild(document.createTextNode(" World!"));<br />
        el.appendChild(newchild);<br />
    }(this));<br />
}<br />
[/css]</p>
<h3>图片缩放</h3>
<p>模拟图片的：max-width 和 max-height (或 min-width 和 min-height)<br />
[css]<br />
.max-width span img {<br />
    max-width:120px;<br />
    max-height:120px;<br />
    zoom:expression(function(el){<br />
        el.style.zoom = "1";</p>
<p>        var resizeImg = function() {<br />
            if (el.width > 120 || el.height > 120) {<br />
                if (el.width > el.height) {<br />
                    el.width = "120";<br />
                    el.height = el.height * (el.width / 120);<br />
                } else {<br />
                    el.height = "120";<br />
                    el.width = el.width * (el.height / 120);<br />
                }<br />
            }<br />
        }</p>
<p>        if (el.complete) {<br />
            resizeImg();<br />
        } else {<br />
            el.onload = function() {<br />
                resizeImg();<br />
            }<br />
        }<br />
    }(this));<br />
}<br />
[/css]</p>
<h3>IE6的鼠标滑过</h3>
<p>a之外元素:hover<br />
[css]<br />
.ie6-hover input:hover, .ie6-hover .h {<br />
    border:1px solid red;<br />
}<br />
.enable-ie6-hover input {<br />
    _zoom:expression(function(el){<br />
        el.style.zoom = "0";<br />
        el.onmouseenter = function() {<br />
            el.className = "h";<br />
        };<br />
        el.onmouseleave = function() {<br />
            el.className = "";<br />
        };<br />
    }(this));<br />
}<br />
[/css]</p>
<h3>IE6行高问题</h3>
<p>line-height bug<br />
[css]<br />
.ie6-line-height-bug { background:#f2f2f2; line-height:50px; zoom:1; }<br />
.ie6-line-height-bug-fixed input {<br />
    _zoom: expression(function(el){<br />
        el.style.zoom = "1";<br />
        var iefixer = document.createElement("b");<br />
        iefixer.style.zoom = 1;<br />
        el.parentNode.insertBefore(iefixer, el);<br />
    }(this));<br />
}<br />
[/css]</p>
